Date.prototype.Format=function(e){var e=e||"yyyy-MM-dd",t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var common={init:function(){this.listnerBinder()},listnerBinder:function(){$(document).on("click",".btn-toggle",function(e){$(this).addClass("active").siblings(".btn-toggle").removeClass("active")}),$(document).on("keyup",".numberInput,.number-input",function(e){var t=window.event?e.keyCode:e.which;8!=t&&9!=t&&46!=t&&37!=t&&39!=t&&(this.value=this.value.replace(/\D/g,""))}),$(document).on("click",".close-layer",function(){layer.closeAll()}),$(document).on("keydown",function(e){if(116==e.keyCode)if(e.preventDefault(),self==top){if(0==document.querySelectorAll("iframe").length)return window.location.reload(),!1;var t=$(".J_menuTab.active").index(),a=$(".J_mainContent iframe").eq(t).attr("src");$(".J_mainContent iframe").eq(t).attr("src",a)}else{var t=$(parent.document.querySelector(".J_menuTab.active")).index(),n=$(parent.document.querySelectorAll(".J_mainContent iframe")[t]);n.attr("src",n.attr("src"))}}),$(document).on("click",".btn-switcher",function(e){$(this).toggleClass("active")}),$(document).on("focus",".domain-input",function(){return""==$(this).val()&&void $(this).val("http://")})},commonReg:{email:/^([a-zA-Z0-9]+[_|\_|\.|-]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,number:/^\d+$/,phone:/^(13|14|15|18|17)[0-9]{9}$/,telphone:/^0\d{2,3}-?\d{8}$/,authCode:/^[0-9a-zA-Z]{4}$/,phoneAuthCode:/^[0-9a-zA-Z]{6}$/,pass:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/,name:/^[\u4E00-\u9FA5]{2,5}$/,identify:/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/,bankCard:/^[0-9]{4,40}$/,validTime:/^[1-9]\d{3}((0\d)|(1[0-2]))$/,safe:/[~#$￥ˇ<>（）\s\?\*\&\\\|\/\[\]\{\}\\^%]/,decimalLimit:/^\d+(?:\.\d{2})?$/,negativeDecimalLimit:/^(-|\d)+(?:\.\d{2})?$/,originFlowNo:/^[0-9]{22}[\-]{1}[0-9]{3}[\-]{1}[0-9]{2}$/},check:function(e,t){return this.commonReg[t].test(e)},checkForm:function(e){"string"==typeof e?$(e):e},ajaxError:function(e){var t=e.message;if(!e.message)switch(e.status){case 200:t="200 No response";break;case 404:t="404 Not Found";break;case 500:t="500 Unexpected server error";break;default:t=e.status+" error,please try again."}layer.msg(t,{icon:2})},getMetrics:function(e,t){if(!e.hasOwnProperty("url")||""==e.url)return console.error("Url is required"),!1;var a={metrics:["sessions"],range:"today"};if(e&&e.constructor==Object)for(var n in e)a.hasOwnProperty(n)&&(a[n]=e[n]);var r={};$.extend(r,a);var o=new Date;switch(a.range){case"today":r.range=o.Format();break;case"yesterday":r.range=new Date(o.getTime()-864e5).Format()+"/"+o.Format();break;case"this_week":r.range=new Date(o.getTime()-864e5*(o.getDay()-1)).Format()+"/"+o.Format();default:r.range=e.range}var i;return $.ajax({url:e.url,type:"POST",dataType:"json",data:r,async:!0,beforeSend:function(){layer.load(2)}}).done(function(e){return 1!=e.status?(common.ajaxError(e),!1):(i=e.data,void("function"==typeof t&&t(i)))}).fail(function(e){return common.ajaxError(e),!1}).always(function(){layer.closeAll("loading")}),i},getChart:function(e,t){if(!e.hasOwnProperty("url")||""==e.url)return console.error("Url is required"),!1;var a={metrics:["sessions"],range:"today",dimensions:["nthDay"]};if(e&&e.constructor==Object)for(var n in e)a[n]=e[n];var r={};$.extend(r,a);var o=new Date;switch(a.range){case"today":r.range=o.Format();break;case"yesterday":r.range=new Date(o.getTime()-864e5).Format()+"/"+o.Format();break;case"this_week":r.range=new Date(o.getTime()-864e5*(o.getDay()-1)).Format()+"/"+o.Format();default:r.range=e.range}var i;return $.ajax({url:e.url,type:"POST",dataType:"json",data:r,async:!0,beforeSend:function(){layer.load(2)}}).done(function(e){return 1!=e.status?(common.ajaxError(e),!1):(i=e.data,void("function"==typeof t&&t(i)))}).fail(function(e){return common.ajaxError(e),!1}).always(function(){layer.closeAll("loading")}),i},getDate:function(){var e=arguments[0]||"now",t=(new Date).getTime(),a=new Date,n="function"==typeof arguments[1];if("number"==typeof e){var r=n?"default":arguments[1],o=n?arguments[1]:arguments[arguments.length-1],i=1e3*Number(e)*3600*24;switch(r){case"ago":i=new Date(t-i).Format();break;case"later":default:i=new Date(t+i).Format()}return"function"==typeof o&&o(i),i}var i,e=""!=e?e:"last-week";switch(e){case"now":i=(new Date).Format();break;case"today":i=[this.getDate(),this.getDate()];break;case"last-7-days":i=[this.getDate(-6),a.Format()];break;case"yesterday":i=[this.getDate(-1),this.getDate(-1)];break;case"this-week":i=[new Date(t-1e3*(a.getDay()-1)*3600*24).Format(),a.Format()];break;case"last-week":var s=new Date(t-6048e5),c=s.getTime()-1e3*(s.getDay()-1)*3600*24;i=[new Date(c).Format(),new Date(c+5184e5).Format()];break;case"last-month":var l=a.getFullYear(),u=a.getMonth();0==u&&(u=12,l-=1),u<10&&(u="0"+u);var d=new Date(l,u,0);i=[l+"-"+u+"-01",l+"-"+u+"-"+d.getDate()];break;case"this-month":var l=a.getFullYear(),u=a.getMonth()+1;u<10&&(u="0"+u);var m=l+"-"+u+"-01",d=new Date(l,u,0),g=l+"-"+u+"-"+a.getDate();$("#filter-date-range-start").val(m),$("#filter-date-range-end").val(g),i=[m,g];break;default:i=!1,console.warn("Invalid Date Range Argument Value: "+e)}var o=n?arguments[1]:arguments[arguments.length-1];return"function"==typeof o&&o(i),i}};window.onload=function(){common.init()};